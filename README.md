# News Parser API

API –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –Ω–æ–≤–æ—Å—Ç–µ–π —Å RBC.ru —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∞–Ω–∞–ª–∏–∑–∞.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üì∞ **–ü–∞—Ä—Å–∏–Ω–≥ –Ω–æ–≤–æ—Å—Ç–µ–π** —Å RBC.ru –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –∏ –¥–∞—Ç–∞–º
- üè¢ **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π –∫–æ–º–ø–∞–Ω–∏–π** —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Natasha
- üòä **–ê–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏** –Ω–æ–≤–æ—Å—Ç–µ–π (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è, –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è)
- üîÑ **–î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è** –Ω–æ–≤–æ—Å—Ç–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- üìä **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–¥–æ–≤ –û–ö–í–≠–î** –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –Ω–æ–≤–æ—Å—Ç–µ–π –æ—Ç—Ä–∞—Å–ª—è–º —ç–∫–æ–Ω–æ–º–∏–∫–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ API —Å–µ—Ä–≤–µ—Ä:
```bash
uvicorn app:app --reload
```

API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8000

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API

### –ü–∞—Ä—Å–∏–Ω–≥ –Ω–æ–≤–æ—Å—Ç–µ–π

–û—Ç–ø—Ä–∞–≤—å—Ç–µ POST –∑–∞–ø—Ä–æ—Å –Ω–∞ `/parse` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

```json
{
  "date_from": "2024-01-01",
  "date_to": "2024-01-31", 
  "query": "–±–∞–Ω–∫–∏"
}
```

–û—Ç–≤–µ—Ç –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ø–∏—Å–æ–∫ –Ω–æ–≤–æ—Å—Ç–µ–π —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–æ–ª—è–º–∏:
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `title` - –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏
- `text` - –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏
- `date` - –¥–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- `source` - –∏—Å—Ç–æ—á–Ω–∏–∫ (RBC.ru)
- `found_companies` - –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–π
- `sentiment` - —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –Ω–æ–≤–æ—Å—Ç–∏
- `sentiment_score` - —á–∏—Å–ª–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (0-1)

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ —Å curl

```bash
curl -X POST "http://localhost:8000/parse" \
     -H "Content-Type: application/json" \
     -d '{
       "date_from": "2024-01-01",
       "date_to": "2024-01-31",
       "query": "–±–∞–Ω–∫–∏"
     }'
```

## –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–æ–≤ –û–ö–í–≠–î

–î–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –Ω–æ–≤–æ—Å—Ç–µ–π –∫–æ–¥–∞–º –û–ö–í–≠–î –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å:

### –ê–Ω–∞–ª–∏–∑ CSV —Ñ–∞–π–ª–∞ —Å –Ω–æ–≤–æ—Å—Ç—è–º–∏

```bash
python okved_analyzer.py parsed_articles_2024-01-01_2024-01-31_–±–∞–Ω–∫–∏.csv
```

–ò–ª–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:

```bash
python okved_analyzer.py input.csv output_okved_analysis.csv
```

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from okved_analyzer import OKVEDAnalyzer

# –°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞
analyzer = OKVEDAnalyzer(similarity_threshold=0.3)

# –ê–Ω–∞–ª–∏–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–π –Ω–æ–≤–æ—Å—Ç–∏
relevant_codes = analyzer.find_relevant_okved_codes(
    news_text="–°–±–µ—Ä–±–∞–Ω–∫ —É–≤–µ–ª–∏—á–∏–ª —Å—Ç–∞–≤–∫–∏ –ø–æ –∫—Ä–µ–¥–∏—Ç–∞–º",
    news_title="–ù–æ–≤–æ—Å—Ç–∏ –±–∞–Ω–∫–æ–≤—Å–∫–æ–≥–æ —Å–µ–∫—Ç–æ—Ä–∞"
)

# –ê–Ω–∞–ª–∏–∑ CSV —Ñ–∞–π–ª–∞
results = analyzer.analyze_news_csv("news.csv")
```

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
python example_okved_usage.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç:
- –ê–Ω–∞–ª–∏–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–π –Ω–æ–≤–æ—Å—Ç–∏
- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ CSV —Ñ–∞–π–ª–∞
- –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –Ω–æ–≤–æ—Å—Ç–µ–π —Å –∫–æ–¥–∞–º–∏ –û–ö–í–≠–î

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
parsing_rbk_lentaru/
‚îú‚îÄ‚îÄ app.py                    # –û—Å–Ω–æ–≤–Ω–æ–µ API –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ NoDuplicates.py          # –ú–æ–¥—É–ª—å –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –Ω–æ–≤–æ—Å—Ç–µ–π
‚îú‚îÄ‚îÄ okved_analyzer.py        # –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∫–æ–¥–æ–≤ –û–ö–í–≠–î
‚îú‚îÄ‚îÄ example_okved_usage.py   # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ okved_codes.csv          # –ë–∞–∑–∞ –∫–æ–¥–æ–≤ –û–ö–í–≠–î
‚îú‚îÄ‚îÄ requirements.txt         # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ Dockerfile              # –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
‚îî‚îÄ‚îÄ README.md               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ú–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è

- **Natasha** - –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π (NER)
- **blanchefort/rubert-base-cased-sentiment-rusentiment** - –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- **paraphrase-multilingual-MiniLM-L12-v2** - –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏
- **Annoy** - –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π –ø—Ä–∏ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏

### –ê–ª–≥–æ—Ä–∏—Ç–º—ã

1. **–î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è**: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –∏ –∞–ª–≥–æ—Ä–∏—Ç–º Annoy –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö –Ω–æ–≤–æ—Å—Ç–µ–π
2. **–ê–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏**: –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—É—é, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—É—é –∏ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—É—é
3. **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –û–ö–í–≠–î**: –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –º–µ–∂–¥—É —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–π –∫–æ–¥–æ–≤ –û–ö–í–≠–î

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- `similarity_threshold` –≤ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏: 0.7 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `similarity_threshold` –≤ –∞–Ω–∞–ª–∏–∑–µ –û–ö–í–≠–î: 0.3 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–¥–æ–≤ –û–ö–í–≠–î –Ω–∞ –Ω–æ–≤–æ—Å—Ç—å: 5

## –í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã

### CSV —Å –Ω–æ–≤–æ—Å—Ç—è–º–∏
–°–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ: `parsed_articles_{date_from}_{date_to}_{query}.csv`

### CSV —Å –∞–Ω–∞–ª–∏–∑–æ–º –û–ö–í–≠–î
–°–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞: `{input_file}_okved_analysis.csv`

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞ –∞–Ω–∞–ª–∏–∑–∞ –û–ö–í–≠–î:
- `news_id` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–æ–≤–æ—Å—Ç–∏
- `news_title` - –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏
- `okved_code` - –∫–æ–¥ –û–ö–í–≠–î
- `okved_description` - –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞ –û–ö–í–≠–î
- `similarity_score` - –æ—Ü–µ–Ω–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º —Å–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.

